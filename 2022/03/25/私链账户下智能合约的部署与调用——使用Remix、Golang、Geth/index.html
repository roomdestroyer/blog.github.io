<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog.github.io/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog.github.io/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog.github.io/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog.github.io/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog.github.io/css/main.css">


<link rel="stylesheet" href="/blog.github.io/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"github.com","root":"/blog.github.io/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="综述智能合约调用是实现一个 DApp 的关键，一个完整的 DApp 包括前端、后端、智能合约及区块 链系统，智能合约的调用是连接区块链与前后端的关键。  智能合约的运行过程是后端服务连接某节点，将 智能合约的调用(交易)发送给节点，节点在验证了交易的合法性后进行全网广播，被矿工打包到 区块中代表此交易得到确认，至此交易才算完成。 就像数据库一样，每个区块链平台都会提供主流 开发语言的 SDK(So">
<meta property="og:type" content="article">
<meta property="og:title" content="SmartContractDeploying">
<meta property="og:url" content="https://github.com/roomdestroyer/2022/03/25/%E7%A7%81%E9%93%BE%E8%B4%A6%E6%88%B7%E4%B8%8B%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E7%9A%84%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E7%94%A8%E2%80%94%E2%80%94%E4%BD%BF%E7%94%A8Remix%E3%80%81Golang%E3%80%81Geth/index.html">
<meta property="og:site_name" content="Zhou Jin&#39;s Blog">
<meta property="og:description" content="综述智能合约调用是实现一个 DApp 的关键，一个完整的 DApp 包括前端、后端、智能合约及区块 链系统，智能合约的调用是连接区块链与前后端的关键。  智能合约的运行过程是后端服务连接某节点，将 智能合约的调用(交易)发送给节点，节点在验证了交易的合法性后进行全网广播，被矿工打包到 区块中代表此交易得到确认，至此交易才算完成。 就像数据库一样，每个区块链平台都会提供主流 开发语言的 SDK(So">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/lxJiEuPSH3bRITd.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/THrh4YZMGpDnXNS.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/7f6oKyNs2W9rIu5.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/jtO8B6dVShFsZ92.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/u5Pqxt27MoRcOen.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/6ad9ede85fe247ffb1b74bed7d4e3cce.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/5IpburolWmMR3T6.jpg">
<meta property="og:image" content="https://img-blog.csdnimg.cn/81adf11425514fa7b73bc89dcc9929fa.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/8a2d05460c7c402a8973eb4017321640.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/U2ZfStbu5H1GOlg.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/cf71e3de3fd74070b3da40d162e0fd08.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAemoyMzMzMzM=,size_20,color_FFFFFF,t_70,g_se,x_16">
<meta property="og:image" content="https://img-blog.csdnimg.cn/692b02913c2c4f26933077f5a5269e6b.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/ChRXYpu89ryZSbJ.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/B6uR5sUgjthoJSw.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/PVwDYFSe6jgKAzM.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/X9ku5M7TimYKAra.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/jYdSZCoQqfUwPgr.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/J96P4VSXvuiHDFz.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/yMKpBQxnHqbrZtT.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/DreEWTuGVza5Sb3.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/K3UC8pdFoZBmR7P.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/NvUnBeRa1H6YEoM.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/qHmfa8QPNJLT3Vh.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/XQOH3Yf9e7EdAn2.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/7qBefwlkA4nxpzm.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/S7EvgNBQmOA4T2y.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/HNL5vBzfwnUilQu.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/OZUDKteNx3jC5gu.png">
<meta property="og:image" content="https://s2.loli.net/2022/03/25/TJ8oMOyaIQSkqfN.png">
<meta property="article:published_time" content="2022-03-25T08:55:23.000Z">
<meta property="article:modified_time" content="2022-03-25T09:05:14.436Z">
<meta property="article:author" content="Zhou Jin">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/03/25/lxJiEuPSH3bRITd.png">

<link rel="canonical" href="https://github.com/roomdestroyer/2022/03/25/%E7%A7%81%E9%93%BE%E8%B4%A6%E6%88%B7%E4%B8%8B%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E7%9A%84%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E7%94%A8%E2%80%94%E2%80%94%E4%BD%BF%E7%94%A8Remix%E3%80%81Golang%E3%80%81Geth/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>SmartContractDeploying | Zhou Jin's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog.github.io/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Zhou Jin's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog.github.io/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog.github.io/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://github.com/roomdestroyer/2022/03/25/%E7%A7%81%E9%93%BE%E8%B4%A6%E6%88%B7%E4%B8%8B%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E7%9A%84%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%B0%83%E7%94%A8%E2%80%94%E2%80%94%E4%BD%BF%E7%94%A8Remix%E3%80%81Golang%E3%80%81Geth/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog.github.io/images/avatar.gif">
      <meta itemprop="name" content="Zhou Jin">
      <meta itemprop="description" content="View my github at @https://github.com/roomdestroyer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhou Jin's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SmartContractDeploying
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-03-25 16:55:23 / Modified: 17:05:14" itemprop="dateCreated datePublished" datetime="2022-03-25T16:55:23+08:00">2022-03-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="综述"><a href="#综述" class="headerlink" title="综述"></a>综述</h3><p>智能合约调用是实现一个 DApp 的关键，一个完整的 DApp 包括前端、后端、智能合约及区块 链系统，智能合约的调用是连接区块链与前后端的关键。</p>
<p><img src="https://s2.loli.net/2022/03/25/lxJiEuPSH3bRITd.png" alt="在这里插入图片描述"></p>
<p>智能合约的运行过程是后端服务连接某节点，将 智能合约的调用(交易)发送给节点，节点在验证了交易的合法性后进行全网广播，被矿工打包到 区块中代表此交易得到确认，至此交易才算完成。</p>
<p>就像数据库一样，每个区块链平台都会提供主流 开发语言的 SDK(Software Development Kit，软件开发工具包)，由于 Geth 本身就是用 Go 语言 编写的，因此若想使用 Go 语言连接节点、发交易，直接在工程内导入 go-ethereum(Geth 源码) 包就可以了，剩下的问题就是流程和 API 的事情了。智能合约被调用的两个关键点是节点和 SDK。</p>
<p>本demo基于Ubuntu18.04 OS，golang_v1.17.5，geth_v1.10.13-stable搭建本地私链，基于Chrome Remix和solidity_v0.4.17开发智能合约代码，通过Metamask将Remix与本地私链进行连接，并将Lottery智能合约部署到本地私链，使用geth客户端新建账户，与智能合约进行交互。</p>
<h4 id="一、环境准备-lt"><a href="#一、环境准备-lt" class="headerlink" title="一、环境准备&lt;"></a>一、环境准备&lt;</h4><ol>
<li><p>在VMWare上新建Ubuntu18.04虚拟机，虚拟机网络与本地进行桥接并同步网卡配置，使得主机的MetaMask能够同步虚拟机中的私链，主机网卡设置同步VMware Network Adapter VMnet1。<br><img src="https://s2.loli.net/2022/03/25/THrh4YZMGpDnXNS.png" alt="在这里插入图片描述"></p>
</li>
<li><p>在Chrome上安装以太坊钱包MetaMask，新建自己的账户，在MetaMask上新建网络，网络名设置为private-chain，网络地址设置为虚拟机ip地址，端口为8545，链ID设置为1330。<br><img src="https://s2.loli.net/2022/03/25/7f6oKyNs2W9rIu5.png" alt="在这里插入图片描述"></p>
</li>
</ol>
<p>RPC URL请确保和虚拟机的ip地址保持一直，端口默认使用8545，链ID与后文中genesis.json中的配置保持一致。使用MetaMask可以访问公网和测试网，几个测试网中Ropsten比较好用，每次发一个币，但是最近(2021&#x2F;12&#x2F;15)由于node4j出bug，Ropsten发笔机直接down掉，其它网络发币非常少，例如Koven每次只发0.0002个ether，Rinkerby发币审核机制非常麻烦，为了避免这些情况，自己在本地搭私链开发时最高效的，测试币随便发。</p>
<ol start="3">
<li>使用如下命令安装geth客户端：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install software-properties-common</span><br><span class="line">sudo add-apt-repository -y ppa:ethereum/ethereum</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install ethereum</span><br></pre></td></tr></table></figure>

<p>安装成功后使用  <code>geth version</code> 查看geth是否成功安装，本环境下的输出为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Geth</span><br><span class="line">Version: 1.10.13-stable</span><br><span class="line">Git Commit: 7a0c19f813e285516f4b525305fd73b625d2dec8</span><br><span class="line">Architecture: amd64</span><br><span class="line">Go Version: go1.17.2</span><br><span class="line">Operating System: linux</span><br><span class="line">GOPATH=</span><br><span class="line">GOROOT=go</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>使用如下命令安装golang环境：<br>首先获得安装包：<a href=https://go.dev/dl/go1.17.5.linux-amd64.tar.gz>https://go.dev/dl/go1.17.5.linux-amd64.tar.gz</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压该文件到/usr/local/go，如果不存在该目录，应该先创建</span></span><br><span class="line">sudo tar -zxvf go1.17.5.linux-amd64.tar.gz</span><br><span class="line"><span class="comment"># 设置环境变量，go的根目录，即刚才解压的目录</span></span><br><span class="line"><span class="built_in">export</span> GOROOT=/usr/local/go</span><br><span class="line"><span class="comment"># 设置环境变量，go的工作目录，可以自行选择</span></span><br><span class="line"><span class="built_in">export</span> GOPATH=/home/ub/go</span><br></pre></td></tr></table></figure></li>
</ol>
<p>安装成功后使用  <code>go version</code> 查看geth是否成功安装，本环境下的输出为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go version go1.17.5 linux/amd64</span><br></pre></td></tr></table></figure>
<p><strong>重要：GO的版本一定要选择v1.17.5以上，后面使用<code>abigen </code>编译代码时需要用到。</strong></p>
<ol start="5">
<li><p>安装Xshell7和Xftp7连接虚拟机中的Ubuntu18.04，方便在主机中使用软件进行开发。&#x2F;&#x2F; 补充一下，如果直接选择在Ubuntu中进行开发，你会面临桌面上全是控制台的情况，难以分清哪个是做什么的，而使用Xshell会获得更好的交互性能，只需在Ubuntu shell中使用 ip a 获取ip地址，在xshell中直接连接即可，开发非常好用，也适合开多个虚拟机。<br><img src="https://s2.loli.net/2022/03/25/jtO8B6dVShFsZ92.png" alt="在这里插入图片描述"></p>
</li>
<li><p>科学上网软件，虚拟机和主机中分别进行安装。有时候网络连接会报错，例如tcp端口被占用、网络无法连接，此时可以尝试禁用虚拟机防火墙，kill 占用tcp端口的进程，或者重启虚拟机。如果重启虚拟机也不行，就关闭主机，等待几分钟，内存全部清空后再开机重来。</p>
</li>
</ol>
<h4 id="二、搭建私链"><a href="#二、搭建私链" class="headerlink" title="二、搭建私链"></a>二、搭建私链</h4><p>在 <code>~/</code> 下使用 <code>mkdir private-chain</code> 新建私链文件夹，在私链文件夹中，使用<code>vim genensis.json</code>新建创世区块配置文件，内容如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;config&quot;</span>: &#123;</span><br><span class="line">		<span class="string">&quot;chainId&quot;</span>: <span class="number">1330</span>,</span><br><span class="line">		<span class="string">&quot;homesteadBlock&quot;</span>: <span class="number">0</span>,</span><br><span class="line">		<span class="string">&quot;eip150Block&quot;</span>: <span class="number">0</span>,</span><br><span class="line">		<span class="string">&quot;eip150Hash&quot;</span>: <span class="string">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span>,</span><br><span class="line">		<span class="string">&quot;eip155Block&quot;</span>: <span class="number">0</span>,</span><br><span class="line">		<span class="string">&quot;eip158Block&quot;</span>: <span class="number">0</span>,</span><br><span class="line">		<span class="string">&quot;byzantiumBlock&quot;</span>: <span class="number">0</span>,</span><br><span class="line"> 		<span class="string">&quot;constantinopleBlock&quot;</span>: <span class="number">0</span>,</span><br><span class="line">		<span class="string">&quot;petersburgBlock&quot;</span>: <span class="number">0</span>,</span><br><span class="line">		<span class="string">&quot;istanbulBlock&quot;</span>: <span class="number">0</span>,</span><br><span class="line">		<span class="string">&quot;ethash&quot;</span>: &#123;&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">&quot;nonce&quot;</span>: <span class="string">&quot;0x0&quot;</span>,</span><br><span class="line">	<span class="string">&quot;timestamp&quot;</span>: <span class="string">&quot;0x5ddf8f3e&quot;</span>,</span><br><span class="line">    <span class="string">&quot;extraData&quot;</span>: <span class="string">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span>,</span><br><span class="line">    <span class="string">&quot;gasLimit&quot;</span>: <span class="string">&quot;0x47b760&quot;</span>,</span><br><span class="line">	<span class="string">&quot;difficulty&quot;</span>: <span class="string">&quot;0x00002&quot;</span>,</span><br><span class="line">	<span class="string">&quot;mixHash&quot;</span>: <span class="string">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span>,</span><br><span class="line">	<span class="string">&quot;coinbase&quot;</span>: <span class="string">&quot;0x0000000000000000000000000000000000000000&quot;</span>,</span><br><span class="line">	<span class="string">&quot;alloc&quot;</span>: &#123; &#125;,</span><br><span class="line">	<span class="string">&quot;number&quot;</span>: <span class="string">&quot;0x0&quot;</span>,</span><br><span class="line">	<span class="string">&quot;gasUsed&quot;</span>: <span class="string">&quot;0x0&quot;</span>,</span><br><span class="line">	<span class="string">&quot;parentHash&quot;</span>: <span class="string">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>各个参数的解析如下：<br><strong>mixhash</strong> ： 一个256位的哈希证明，与nonce相结合，已经对该块进行了足够的计算：工作量证明（PoW）。 nonce和mixhash的组合必须满足黄皮书4.3.4中描述的数学条件，它允许验证块确实已经加密地挖掘。</p>
<p><strong>nonce</strong>：证明64位散列与混合散列相结合，在该块上进行了足够的计算：工作量证明（PoW）。 nonce和mixhash的组合必须满足黄皮书4.3.4中描述的数学条件，并允许验证块确实已经加密地挖掘。nonce是加密安全的挖掘工作证明，证明在确定该令牌值时已经花费了特定量的计算。 （Yellowpager，11.5。采矿工作证明）。</p>
<p><strong>difficulty</strong>：标量值，对应于在该块的随机数发现期间应用的难度级别。它定义了挖掘目标，可以根据前一个块的难度级别和时间戳来计算。难度越高，Miner必须执行的统计更多计算才能发现有效块。此值用于控制区块链的块生成时间，将块生成频率保持在目标范围内。在测试网络上，我们将此值保持为低以避免在测试期间等待，因为在区块链上执行事务需要发现有效的块。</p>
<p><strong>alloc</strong>：允许定义预先填充的钱包列表。这是以太坊特定功能，可以处理“以太网预售”时期。</p>
<p><strong>coinbase</strong>：从该块的成功挖掘中收集的所有奖励（以太币）的160位地址已被转移。它们是采矿奖励本身和合同交易执行退款的总和，在创建新Block时，Miner的设置会设置该值。</p>
<p><strong>timestamp</strong>：标量值等于此块开始时Unix time()函数的合理输出。该机制在块之间的时间方面强制实施稳态。最后两个块之间的较小周期导致难度级别的增加，从而导致找到下一个有效块所需的额外计算。如果周期太大，则减少了难度和到下一个块的预期时间。时间戳还允许验证链内的块顺序（黄皮书，4.3.4。（43））。简单地说，timestamp就是该私链启动时的时间。</p>
<p><strong>parentHash</strong>：整个父块头的Keccak 256位哈希（包括其nonce和mixhash）。指向父块的指针，从而有效地构建块链。在Genesis块的情况下它为0。</p>
<p><strong>extraData</strong>：可选，但最多32字节长的空间。</p>
<p><strong>gasLimit</strong>：可选，为标量值，它等于每个gas支出的限制。gas通常需要设置得很高，以避免在测试期间受到此阈值的限制，但这并不表示我们不应该关注智能合约的gas消耗量。通常来说，过低的gas可能导致交易失败，过高的gas容易导致交易的可信度降低，一个合理的gas才能提高交易的效率。</p>
<p>使用命令 <code>geth --datadir ./ init ./genesis.json</code> 使用创世区块初始化私链配置，看到如下输出，说明私链搭建成功：</p>
<p><img src="https://s2.loli.net/2022/03/25/u5Pqxt27MoRcOen.png" alt="在这里插入图片描述"></p>
<h4 id="三、连接私链与MetaMask"><a href="#三、连接私链与MetaMask" class="headerlink" title="三、连接私链与MetaMask"></a>三、连接私链与MetaMask</h4><p>使用命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geth --datadir ./ --networkid 1330 --http --http.addr [HTTP_ADDRESS] --http.vhosts <span class="string">&quot;*&quot;</span> --http.port 8545 --http.api <span class="string">&#x27;db,net,eth,web3,personal&#x27;</span> --nodiscover --allow-insecure-unlock --http.corsdomain <span class="string">&quot;*&quot;</span> console 2&gt;&gt;geth.log</span><br></pre></td></tr></table></figure>
<p>运行本地私链，注意在之前版本中geth需要使用<code>--rpc</code>连接本地网络，在新版本中则采用了<code>--http</code>，在之后版本中各个参数的写法也很可能会更新，具体参考<a target="_blank" rel="noopener" href="https://geth.ethereum.org/docs/"><em>geth官方文档</em>：</a></p>
<p>其中每个参数的作用为：</p>
<p><strong>–datadir</strong>：geth当前的工作目录</p>
<p><strong>–networkid</strong>：网络id，最好与chainID保持一致</p>
<p><strong>–http</strong>：开启远程调用模式，相当于之前版本的 –rpc ，即使MetaMask能够与其建立连接</p>
<p><strong>–http.addr</strong>：配置网络ip地址，例如 <a target="_blank" rel="noopener" href="http://128.120.0.3/">http://128.120.0.3</a></p>
<p><strong>–http.port</strong>：定义ip端口，与MetaMask保持一致，默认为8545</p>
<p><strong>–http.api</strong>：启用远程调用api，尽量多启用几个</p>
<p><strong>–nodiscover</strong>：不发现本地结点，如果不设置这个就会在log里面一直looking for peers</p>
<p><strong>–allow-insecure-unlock</strong>：允许解锁账户，这样才能交易</p>
<p><strong>–http.corsdomain</strong>：定义网段上的哪些主机能发现</p>
<p>根据上述命令，geth日志更新到geth.log中，新建Shell，打开工作目录，使用命令<code>tail -f geth.log</code>实时在控制台中跟踪日志。</p>
<p>私链按上述操作配置好后，在MetaMask中切换到本地网络private-chain，将MetaMask与本地私链进行连接。在Chrome中打开Remix编译器英文版(中文版有bug)。</p>
<p>如果此时MetaMask与Remix没有连接，手动选择 已连接的网站-&gt;手动连接到当前站点，此时本地私链、MetaMask、Remix已经连接到了同一网段中。</p>
<p>当私链运行起来后，如下是一些常用的命令：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">eth.accounts                  <span class="comment">//查询账户</span></span><br><span class="line">personal.newAccount()         <span class="comment">//创建一个账户</span></span><br><span class="line">eth.blockNumber               <span class="comment">//查看区块链数</span></span><br><span class="line">miner.start()                 <span class="comment">//开始挖矿</span></span><br><span class="line">miner.stop()                  <span class="comment">//停止挖矿</span></span><br><span class="line">eth.getBalance(eth.accounts[<span class="number">0</span>])         <span class="comment">//获取账户的余额</span></span><br><span class="line">web3.fromWei(eth.getBalance(eth.accounts[<span class="number">0</span>]), <span class="string">&quot;ether&quot;</span>)    <span class="comment">//获取账户的余额</span></span><br><span class="line">eth.getBlock(<span class="number">0</span>)                                           <span class="comment">//获取区块信息</span></span><br><span class="line">personal.unlockAccount(eth.accounts[<span class="number">0</span>])                   <span class="comment">//账号解锁</span></span><br><span class="line">eth.sendTransaction(&#123;from:eth.accounts[<span class="number">0</span>], to:<span class="string">&quot;ACCOUNT_ADDR&quot;</span>,value:web3.toWei(<span class="number">3</span>, <span class="string">&quot;ether&quot;</span>)&#125;)          <span class="comment">//转账</span></span><br><span class="line">eth.sendTransaction(&#123;from:eth.accounts[<span class="number">0</span>], to:eth.accounts[<span class="number">1</span>],value:web3.toWei(<span class="number">4</span>, <span class="string">&quot;ether&quot;</span>)&#125;)         <span class="comment">//转账</span></span><br><span class="line">eth.getTransaction(<span class="string">&quot;&quot;</span>)                <span class="comment">//查询交易</span></span><br><span class="line">eth.getCode(<span class="string">&quot;&quot;</span>)                       <span class="comment">//查询合约是否部署成功</span></span><br></pre></td></tr></table></figure>

<p>新建账户，<code>miner.start(20)</code> 开启20个线程进行挖矿，当新的区块被确认后，交易队列、合约部署等操作才能被执行。从accounts[0]中转10个ether到MetaMask中，用于合约部署和交易。核对矿工账号是否为当前账户：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; eth.coinbase == eth.accounts[0]</span><br><span class="line"><span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>（注：如果线程开的太多，例如开400个，geth客户端将会非常卡，如果开的太少，例如1个，则挖矿的速度会很慢。经过测试，开20个可以保证挖矿速度的同时提高客户端的流畅性）</p>
<p>然后，为在geth中使用go部署合约，需要将MetaMask账户导入到私链中。在MetaMask界面获取私钥后，在<code>~/private-chain/</code>下使用命令<code>vim metamask-sk</code>将私钥写入，然后使用如下命令将MetaMask账户导入本地私链：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geth account import ./metamask-sk</span><br></pre></td></tr></table></figure>

<p>输入密码，观察到下列输出后导入成功：<br><img src="https://img-blog.csdnimg.cn/6ad9ede85fe247ffb1b74bed7d4e3cce.png" alt="在这里插入图片描述"></p>
<p>获取私钥的方法为：</p>
<p><img src="https://s2.loli.net/2022/03/25/5IpburolWmMR3T6.jpg" alt="在这里插入图片描述"></p>
<p>然后使用命令<code>geth account list</code>查看导入的账户私钥存储位置：<br><img src="https://img-blog.csdnimg.cn/81adf11425514fa7b73bc89dcc9929fa.png" alt="在这里插入图片描述"></p>
<p>使用如下命令将该文件转移到路径<code>~/home/ub/private-key/keystore</code>下，待后面部署合约使用（路径根据自己的环境进行修改）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -r /home/ub/.ethereum/keystore/UTC--2021-12-14T14-52-22.064443917Z--68e9f0c38e31b5d4d25abefee28938ac263205a5 ./keystore/UTC--2021-12-14T14-52-22.064443917Z--68e9f0c38e31b5d4d25abefee28938ac263205a5</span><br></pre></td></tr></table></figure>


<p><img src="https://img-blog.csdnimg.cn/8a2d05460c7c402a8973eb4017321640.png" alt="在这里插入图片描述"></p>
<p>有时候，在MetaMask上进行交易会报错，可能是因为内部ID出了问题，需要重设一下账户，方法如下：</p>
<p><img src="https://s2.loli.net/2022/03/25/U2ZfStbu5H1GOlg.png" alt="在这里插入图片描述"></p>
<p>如果还不成功，尝试重启geth或重启虚拟机。</p>
<h4 id="四、Remix部署合约"><a href="#四、Remix部署合约" class="headerlink" title="四、Remix部署合约"></a>四、Remix部署合约</h4><p>打开Remix，在contracts目录下新建Lottery.sol源文件，输入以下代码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.4.17;</span><br><span class="line"></span><br><span class="line">contract Lottery &#123;</span><br><span class="line">    address public manager;</span><br><span class="line">    address[] public players;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> Lottery() public &#123;</span><br><span class="line">        manager = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> enter() public payable &#123;</span><br><span class="line">        require(msg.value &gt;= 0.0000000001 ether);</span><br><span class="line">        players.push(msg.sender);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> random() public view returns (uint) &#123;</span><br><span class="line">        <span class="built_in">return</span> uint(keccak256(block.difficulty, now, players.length));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> pickWinner() public restricted &#123;</span><br><span class="line">        uint index = random() % players.length;</span><br><span class="line">        players[index].transfer(this.balance);</span><br><span class="line">        players = new address[](0);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    modifier <span class="function"><span class="title">restricted</span></span>() &#123;</span><br><span class="line">        require(msg.sender == manager);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> getPlayers() public view returns (address[]) &#123;</span><br><span class="line">        <span class="built_in">return</span> players;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>选择对应的solidity版本进行编译，然后发布到本地私链中，选择以下按钮部署智能合约：<br><img src="https://img-blog.csdnimg.cn/cf71e3de3fd74070b3da40d162e0fd08.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAemoyMzMzMzM=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>由于部署合约需要一定的gas，因此需要确保当前账户下拥有足够的ether。等待下一个区块被矿工确认后，部署即可完成：<br><img src="https://img-blog.csdnimg.cn/692b02913c2c4f26933077f5a5269e6b.png" alt="在这里插入图片描述"></p>
<h4 id="五、几个重要的地址"><a href="#五、几个重要的地址" class="headerlink" title="五、几个重要的地址"></a>五、几个重要的地址</h4><ol>
<li>MetaMask钱包地址，即主账户地址，它是连接geth客户端、MetaMask与Remix的枢纽：</li>
</ol>
<p><img src="https://s2.loli.net/2022/03/25/ChRXYpu89ryZSbJ.png" alt="在这里插入图片描述"></p>
<ol start="2">
<li><p>矿工地址：它是geth客户端中进行挖矿、转账的地址，从其中挖矿并转账到MetaMask用于合约部署和发布，整个私链的以太币都由矿工挖矿而来，默认为<code>eth.accounts[0]</code></p>
</li>
<li><p>合约地址：发布只能合约后，合约拥有本身的地址，任何调用该合约的方法本质上都是与合约地址进行交互，查看合约地址的方法为：<br> <img src="https://s2.loli.net/2022/03/25/B6uR5sUgjthoJSw.png" alt="在这里插入图片描述"></p>
</li>
<li><p>用户地址：当智能合约部署到私链中后，可以在其中新建账户，使用账户与合约进行交互，每个账户地址都保存在eth.accounts中。</p>
</li>
</ol>
<h4 id="六、Golang部署合约"><a href="#六、Golang部署合约" class="headerlink" title="六、Golang部署合约"></a>六、Golang部署合约</h4><p>①参考<a target="_blank" rel="noopener" href="https://geth.ethereum.org/docs/install-and-build/installing-geth">geth官方文档</a>，首先使用<code>go version</code>检查环境下的go版本是否至少为以下版本，必须保证版本正确：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go version go1.17.5 linux/amd64</span><br></pre></td></tr></table></figure>

<p>同时设置 go 的环境变量：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go <span class="built_in">env</span> -w GOBIN=/Users/youdi/go/bin</span><br><span class="line">go <span class="built_in">env</span> -w GO111MODULE=on</span><br></pre></td></tr></table></figure>

<p>如果遇到 go mod 报错提示，在工作目录下使用下列命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go mod init [xxx]</span><br></pre></td></tr></table></figure>

<p>②在Remix中获得合约的ByteCode，复制在临时文件中，提取其中的object属性，然后在<code>~/private-chain</code>下新建文件：<code>vim Lottery.bin</code>，将object属性复制进去：<br><img src="https://s2.loli.net/2022/03/25/PVwDYFSe6jgKAzM.png" alt="在这里插入图片描述"></p>
<p><img src="https://s2.loli.net/2022/03/25/X9ku5M7TimYKAra.png" alt="在这里插入图片描述"></p>
<p><img src="https://s2.loli.net/2022/03/25/jYdSZCoQqfUwPgr.png" alt="在这里插入图片描述"></p>
<p>③在Remix中获得合约的ABI，然后在<code>~/private-chain</code>下新建文件：<code>vim Lottery.abi</code>，将该属性属性复制进去：</p>
<p><img src="https://s2.loli.net/2022/03/25/J96P4VSXvuiHDFz.png" alt="在这里插入图片描述"></p>
<p><img src="https://s2.loli.net/2022/03/25/yMKpBQxnHqbrZtT.png" alt="在这里插入图片描述"></p>
<p>④使用命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abigen --abi Lottery.abi --pkg main --<span class="built_in">type</span> Lottery --out Lottery.go --bin Lottery.bin</span><br></pre></td></tr></table></figure>

<p>这将为 Lottery 合约生成一个类型安全的 Go 绑定，生成的 Lottery.go 中文件保存着合约绑定与部署的所有方法，新建一个 deploy.go 来调用其中的 API 进行合约部署，deploy.go中填写如下内容：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">        <span class="string">&quot;fmt&quot;</span></span><br><span class="line">        <span class="string">&quot;log&quot;</span></span><br><span class="line">        <span class="string">&quot;math/big&quot;</span></span><br><span class="line">        <span class="string">&quot;strings&quot;</span></span><br><span class="line">        <span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;github.com/ethereum/go-ethereum/accounts/abi/bind&quot;</span></span><br><span class="line">        <span class="string">&quot;github.com/ethereum/go-ethereum/ethclient&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&quot;&#123;\&quot;address\&quot;:\&quot;68e9f0c38e31b5d4d25abefee28938ac263205a5\&quot;,\&quot;crypto\&quot;:&#123;\&quot;cipher\&quot;:\&quot;aes-128-ctr\&quot;,\&quot;ciphertext\&quot;:\&quot;ffe83f793f03e5eb3d49abb5fc838ff65884a9c34a05b897f3032069694623a6\&quot;,\&quot;cipherparams\&quot;:&#123;\&quot;iv\&quot;:\&quot;710df5b6c32c8102e2bd983f7c46384c\&quot;&#125;,\&quot;kdf\&quot;:\&quot;scrypt\&quot;,\&quot;kdfparams\&quot;:&#123;\&quot;dklen\&quot;:32,\&quot;n\&quot;:262144,\&quot;p\&quot;:1,\&quot;r\&quot;:8,\&quot;salt\&quot;:\&quot;92dc432c302bd34de65374e00d295d276531126f1e887c4a7e00d65359468340\&quot;&#125;,\&quot;mac\&quot;:\&quot;ecda1dcc570f155c0fa0edd1d81c538469e0dbc557ad82add757cb8f23c07baf\&quot;&#125;,\&quot;id\&quot;:\&quot;b575f386-fecd-449f-a673-1d62fbd4a386\&quot;,\&quot;version\&quot;:3&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// Create an IPC based RPC connection to a remote node and an authorized transactor</span></span><br><span class="line">        <span class="comment">// conn, err := ethclient.Dial(&quot;/home/ub/private-chain/geth.ipc&quot;)</span></span><br><span class="line">        conn, err := ethclient.Dial(<span class="string">&quot;http://101.76.247.184:8545&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">                        log.Fatalf(<span class="string">&quot;Failed to connect to the Ethereum client: %v&quot;</span>, err)</span><br><span class="line">        &#125;</span><br><span class="line">        auth, err := bind.NewTransactorWithChainID(strings.NewReader(key), <span class="string">&quot;123&quot;</span>, big.NewInt(<span class="number">1330</span>))</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">                        log.Fatalf(<span class="string">&quot;Failed to create authorized transactor: %v&quot;</span>, err)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Deploy a new awesome contract for the binding demo</span></span><br><span class="line">        <span class="comment">// address, tx, Lottery, err := DeployLottery(auth, conn)//  new(big.Int), &quot;Contracts in Go!!!&quot;, 0, &quot;Go!&quot;)</span></span><br><span class="line">        address, tx, _, err := DeployLottery(auth, conn)<span class="comment">//, big.NewInt(1337), &quot;Contracts in Go!!!&quot;, 0, &quot;Go!&quot;)</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">                        log.Fatalf(<span class="string">&quot;Failed to deploy new Lottery contract: %v&quot;</span>, err)</span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;Contract pending deploy: 0x%x\n&quot;</span>, address)</span><br><span class="line">        fmt.Printf(<span class="string">&quot;Transaction waiting to be mined: 0x%x\n\n&quot;</span>, tx.Hash())</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Don&#x27;t even wait, check its presence in the local pending state</span></span><br><span class="line">        time.Sleep(<span class="number">250</span> * time.Millisecond) <span class="comment">// Allow it to be processed by the local node :P</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        name, err := Lottery.Name(&amp;bind.CallOpts&#123;Pending: true&#125;)</span></span><br><span class="line"><span class="comment">        if err != nil &#123;</span></span><br><span class="line"><span class="comment">                        log.Fatalf(&quot;Failed to retrieve pending name: %v&quot;, err)</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        fmt.Println(&quot;Pending name:&quot;, name)</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">//fmt.Print(&quot;%x&quot;,Lottery)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>其中，下列几个地方需要自行配置：</p>
<ol>
<li><strong>const key</strong> 此属性为合约部署的账户，填写账户信息的.json配置文件，在当前目录下的 keystore&#x2F; 文件夹中，打开其中与MetaMask绑定的账户，复制其中的所有信息，打开 <a target="_blank" rel="noopener" href="https://www.bejson.com/jsonviewernew/">json文件浏览器</a>，复制到其中并选择<code>删除空格并转义</code>，将转义到的字符串复制到 key 变量中；</li>
</ol>
<p><img src="https://s2.loli.net/2022/03/25/DreEWTuGVza5Sb3.png" alt="在这里插入图片描述"></p>
<ol start="2">
<li><strong>conn, err :&#x3D; ethclient.Dial(“<a href="http://101.76.247.184:8545&quot;">http://101.76.247.184:8545&quot;</a>)</strong>  函数的参数应该是本地私链的ip地址，可以从MetaMask中查看，也可以在启动 geth 的参数中进行设置：</li>
</ol>
<p><img src="https://s2.loli.net/2022/03/25/K3UC8pdFoZBmR7P.png" alt="在这里插入图片描述"></p>
<ol start="3">
<li><pre><code>auth, err := bind.NewTransactorWithChainID(strings.NewReader(key), &quot;123&quot;, big.NewInt(1330))
</code></pre>
</li>
</ol>
<p>该函数中的第二个元素为私链账户的密码，第三个元素为chainID。注意到<a target="_blank" rel="noopener" href="https://geth.ethereum.org/docs/install-and-build/installing-geth">geth官方文档</a>中仍然使用了下列的错误写法：</p>
<p><img src="https://s2.loli.net/2022/03/25/NvUnBeRa1H6YEoM.png" alt="在这里插入图片描述"></p>
<p>使用此API会报错，翻看 go-ethereum 源代码可以发现，该接口早在2020年底就进行了舍弃，新版的函数接口应该是更新的 <strong>NewTransactorWithChainID</strong> </p>
<p><img src="https://s2.loli.net/2022/03/25/qHmfa8QPNJLT3Vh.png" alt="在这里插入图片描述"></p>
<p><img src="https://s2.loli.net/2022/03/25/XQOH3Yf9e7EdAn2.png" alt="在这里插入图片描述"></p>
<p>新的接口中增加了chainID参数，进一步保证了合约部署的安全性。此时，文件夹下的目录结构为：</p>
<p><img src="https://s2.loli.net/2022/03/25/7qBefwlkA4nxpzm.png" alt="在这里插入图片描述"></p>
<p>完成上述修改后，在目录 <code>~/private-chain</code> 下运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go run *.go</span><br></pre></td></tr></table></figure>

<p>编译所有代码，控制台中有以下输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Contract pending deploy: 0x2566a7db5d30634e20b77f556266de324239c250</span><br><span class="line">Transaction waiting to be mined: 0xc991870c2a4779c0b42571bc3a28c214298fd8112637f351248e71ba52371ff8</span><br></pre></td></tr></table></figure>

<p>表明合约以部署到本第私链中，合约地址为 0x2566a7db5d30634e20b77f556266de324239c250，已加入到交易队列中，等待当下一个块被矿工挖出来后，合约将被确认。</p>
<p>⑤回到运行私链的控制台中，输入以下命令测试合约是否部署成功：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eth.getCode(<span class="string">&quot;0x2566a7db5d30634e20b77f556266de324239c250&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>若观察到以下输出说明部署成功：</p>
<p><img src="https://s2.loli.net/2022/03/25/S7EvgNBQmOA4T2y.png" alt="在这里插入图片描述"></p>
<p>至此，智能合约已使用 golang 部署到了本地私链中，合约地址为 MetaMask 绑定的地址。在此期间，可能会遇到 golang 版本不兼容或者是开发包不全的情况，需要对不全的包逐一使用 <code>git clone</code>下载到本地。</p>
<h4 id="七、调用合约"><a href="#七、调用合约" class="headerlink" title="七、调用合约"></a>七、调用合约</h4><p>智能合约ABI介绍：<br>ABI (Application Binary Interface) 应用程序二进制接口，如果理解 API 就很容易了解 ABI。简单来说，API 是程序与程序间互动的接口。这个接口包含程序提供外界存取所需的 functions、variables 等。ABI 也是程序间互动的接口，但程序是被编译后的 binary code。所以同样的接口，但传递的是 binary 格式的信息。所以 ABI 就要描述如何 decode&#x2F;encode 程序间传递的 binary 信息。下图以 Linux 为例，描述 Linux 中 API、ABI 和程序的关系：</p>
<p><img src="https://s2.loli.net/2022/03/25/HNL5vBzfwnUilQu.png" alt="请添加图片描述"></p>
<p>在 Ethereum 智能合约可以被大家使用前，必须先被部署到区块链上。</p>
<p>从智能合约的代码到使用智能合约，大概包含几个步骤：</p>
<pre><code>1.编写智能合约的代码（一般是用 Solidity 写）
2.编译智能合约的代码变成可在 EVM 上执行的 bytecode（binary code）。同时可以通过编译取得智能合约的 ABI
3.部署智能合约，实际上是把 bytecode 存储在链上（通过一个transaction），并取得一个专属于这个合约的地址
4.如果要写个程序调用这个智能合约，就要把信息发送到这个合约的地址（一样的也是通过一个 transaction）。Ethereum 节点会根据输入的信息，选择要执行合约中的哪一个 function 和要输入的参数。而要如何知道這这个智能合约提供哪些 function 以及应该要传入什么样的参数？这些信息就是记录在智能合约的 ABI。
</code></pre>
<p>此时，本 demo 已使用两种方法在本地私链部署上了智能合约，一种是基于 MetaMask 钱包，另一种是基于 Golang ，下面对已部署的合约进行合约调用：</p>
<p>①在geth客户端定义该智能合约的interface，在钱包中可以找到abi，将abi复制到 <a target="_blank" rel="noopener" href="https://www.bejson.com/jsonviewernew/">jsonview</a> 中去除空格并赋值到变量：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var abi = [&#123;<span class="string">&quot;constant&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;inputs&quot;</span>:[],<span class="string">&quot;name&quot;</span>:<span class="string">&quot;manager&quot;</span>,<span class="string">&quot;outputs&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;address&quot;</span>&#125;],<span class="string">&quot;payable&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;stateMutability&quot;</span>:<span class="string">&quot;view&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;function&quot;</span>&#125;,&#123;<span class="string">&quot;constant&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;inputs&quot;</span>:[],<span class="string">&quot;name&quot;</span>:<span class="string">&quot;pickWinner&quot;</span>,<span class="string">&quot;outputs&quot;</span>:[],<span class="string">&quot;payable&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;stateMutability&quot;</span>:<span class="string">&quot;nonpayable&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;function&quot;</span>&#125;,&#123;<span class="string">&quot;constant&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;inputs&quot;</span>:[],<span class="string">&quot;name&quot;</span>:<span class="string">&quot;random&quot;</span>,<span class="string">&quot;outputs&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;uint256&quot;</span>&#125;],<span class="string">&quot;payable&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;stateMutability&quot;</span>:<span class="string">&quot;view&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;function&quot;</span>&#125;,&#123;<span class="string">&quot;constant&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;inputs&quot;</span>:[],<span class="string">&quot;name&quot;</span>:<span class="string">&quot;getPlayers&quot;</span>,<span class="string">&quot;outputs&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;address[]&quot;</span>&#125;],<span class="string">&quot;payable&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;stateMutability&quot;</span>:<span class="string">&quot;view&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;function&quot;</span>&#125;,&#123;<span class="string">&quot;constant&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;inputs&quot;</span>:[],<span class="string">&quot;name&quot;</span>:<span class="string">&quot;enter&quot;</span>,<span class="string">&quot;outputs&quot;</span>:[],<span class="string">&quot;payable&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;stateMutability&quot;</span>:<span class="string">&quot;payable&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;function&quot;</span>&#125;,&#123;<span class="string">&quot;constant&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;inputs&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;uint256&quot;</span>&#125;],<span class="string">&quot;name&quot;</span>:<span class="string">&quot;players&quot;</span>,<span class="string">&quot;outputs&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;address&quot;</span>&#125;],<span class="string">&quot;payable&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;stateMutability&quot;</span>:<span class="string">&quot;view&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;function&quot;</span>&#125;,&#123;<span class="string">&quot;inputs&quot;</span>:[],<span class="string">&quot;payable&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;stateMutability&quot;</span>:<span class="string">&quot;nonpayable&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;constructor&quot;</span>&#125;];</span><br></pre></td></tr></table></figure>

<p>②定义该智能合约的地址：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var address = <span class="string">&quot;0x2566a7db5d30634e20b77f556266de324239c250&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>③取得智能合约的实例，通过abi和合约地址取得智能合约的实例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var Lottery = web3.eth.contract(abi).at(address);</span><br></pre></td></tr></table></figure>

<p>④调用合约函数：</p>
<p>在当前链下新建账户，使一共有6名账户，对每一名账户进行命名：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var user0 = web3.eth.accounts[0];</span><br><span class="line">var user1 = web3.eth.accounts[1];</span><br><span class="line">var user2 = web3.eth.accounts[2];</span><br><span class="line">var user3 = web3.eth.accounts[3];</span><br><span class="line">var user4 = web3.eth.accounts[4];</span><br><span class="line">var user5 = web3.eth.accounts[5];</span><br></pre></td></tr></table></figure>


<p>同时，为每一个账户预置资金，当做参与博彩游戏的本金。</p>
<p><img src="https://s2.loli.net/2022/03/25/OZUDKteNx3jC5gu.png" alt="在这里插入图片描述"></p>
<p>当上述交易被确认后，让每一名玩家都参与到博彩游戏中来：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Lottery.enter.sendTransaction(&#123;from: user0, value:web3.toWei(1, <span class="string">&quot;ether&quot;</span>), gas: 1000000&#125;);</span><br><span class="line">Lottery.enter.sendTransaction(&#123;from: user1, value:web3.toWei(1, <span class="string">&quot;ether&quot;</span>), gas: 1000000&#125;);</span><br><span class="line">Lottery.enter.sendTransaction(&#123;from: user2, value:web3.toWei(1, <span class="string">&quot;ether&quot;</span>), gas: 1000000&#125;);</span><br><span class="line">Lottery.enter.sendTransaction(&#123;from: user3, value:web3.toWei(1, <span class="string">&quot;ether&quot;</span>), gas: 1000000&#125;);</span><br><span class="line">Lottery.enter.sendTransaction(&#123;from: user4, value:web3.toWei(1, <span class="string">&quot;ether&quot;</span>), gas: 1000000&#125;);</span><br><span class="line">Lottery.enter.sendTransaction(&#123;from: user5, value:web3.toWei(1, <span class="string">&quot;ether&quot;</span>), gas: 1000000&#125;);</span><br></pre></td></tr></table></figure>

<p>此时，账户 user2 拥有6名玩家投入的6个ether，他的任务是随机 pick 一位 winner 获得所有奖励，为此，为 user2 调用以下方法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Lottery.random()            <span class="comment"># 选择随机数</span></span><br><span class="line">Lottery.getPlayers()        <span class="comment"># 查看当前玩家</span></span><br><span class="line">personal.unlockAccount(eth.accounts[2])    <span class="comment">#解锁账户</span></span><br><span class="line">Lottery.pickWinner.sendTransaction(&#123;from: user2, gas: 1000000&#125;);   <span class="comment"># 选择赢家</span></span><br></pre></td></tr></table></figure>

<p>最后使用 <code>web3.fromWei(eth.getBalance(eth.accounts[i), &quot;ether&quot;)</code> 查看每一名玩家的余额，发现 winner 是 1，即他获得了其余5名玩家的5个 ether：</p>
<p><img src="https://s2.loli.net/2022/03/25/TJ8oMOyaIQSkqfN.png" alt="在这里插入图片描述"></p>
<p>其中，账户0是 coinbase，之前余额为190，账户2位 MetaMask 钱包地址，之前余额为59，其余账户之前余额均为4，账户2获得了其它5名玩家的5个ether，他最后的余额为 9。当然，每名玩家在交易的过程中要支付一定的  gas 手续费。至此，本 demo 功能基本完成，后续会尝试再从 web3.js 上寻求优化的空间。</p>
<p>最常使用的一些命令如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始化私链：</span></span><br><span class="line">cd <span class="keyword">private</span>-chain</span><br><span class="line">geth --datadir ./ init ./genesis.json</span><br><span class="line"><span class="comment">// 跑私链：</span></span><br><span class="line">cd <span class="keyword">private</span>-chain</span><br><span class="line">geth --datadir ./ --networkid <span class="number">1330</span> --http --http.addr <span class="number">101.76</span><span class="number">.247</span><span class="number">.184</span> --http.vhosts <span class="string">&quot;*&quot;</span> --http.port <span class="number">8545</span> --http.api <span class="string">&#x27;db,net,eth,web3,personal&#x27;</span> --nodiscover --allow-insecure-unlock --http.corsdomain <span class="string">&quot;*&quot;</span> console <span class="number">2</span>&gt;&gt;geth.log</span><br><span class="line">geth --dev                                     --http --http.addr <span class="number">101.76</span><span class="number">.247</span><span class="number">.184</span> --http.vhosts <span class="string">&quot;*&quot;</span> --http.port <span class="number">8545</span> --http.api <span class="string">&#x27;db,net,eth,web3,personal&#x27;</span> --nodiscover --allow-insecure-unlock --http.corsdomain <span class="string">&quot;*&quot;</span> console <span class="number">2</span>&gt;&gt;geth.log</span><br><span class="line"><span class="comment">// 实时查看日志： </span></span><br><span class="line">cd <span class="keyword">private</span>-chain</span><br><span class="line">tail -f geth.log</span><br><span class="line"></span><br><span class="line">eth.accounts                                <span class="comment">//查询账户</span></span><br><span class="line">personal.<span class="built_in">newAccount</span>()                       <span class="comment">//创建一个账户</span></span><br><span class="line">eth.blockNumber                             <span class="comment">//查看区块链数</span></span><br><span class="line">miner.<span class="built_in">start</span>()                               <span class="comment">//开始挖矿</span></span><br><span class="line">miner.<span class="built_in">stop</span>()                                <span class="comment">//停止挖矿</span></span><br><span class="line">eth.<span class="built_in">getBalance</span>(eth.accounts[<span class="number">0</span>])             <span class="comment">//获取账户的余额</span></span><br><span class="line">web3.<span class="built_in">fromWei</span>(eth.<span class="built_in">getBalance</span>(eth.accounts[<span class="number">0</span>]), <span class="string">&quot;ether&quot;</span>)</span><br><span class="line">eth.<span class="built_in">getBlock</span>(<span class="number">0</span>)                             <span class="comment">//获取区块信息</span></span><br><span class="line">personal.<span class="built_in">unlockAccount</span>(eth.accounts[<span class="number">0</span>])     <span class="comment">//账号解锁</span></span><br><span class="line">eth.<span class="built_in">sendTransaction</span>(&#123;from:eth.accounts[<span class="number">0</span>], to:<span class="string">&quot;0x68e9F0c38e31b5D4D25AbEfEE28938Ac263205a5&quot;</span>,value:web3.<span class="built_in">toWei</span>(<span class="number">1</span>, <span class="string">&quot;ether&quot;</span>)&#125;) </span><br><span class="line">eth.<span class="built_in">sendTransaction</span>(&#123;from:eth.accounts[<span class="number">0</span>], to:eth.accounts[<span class="number">1</span>],value:web3.<span class="built_in">toWei</span>(<span class="number">4</span>, <span class="string">&quot;ether&quot;</span>)&#125;)     </span><br><span class="line">eth.<span class="built_in">getTransaction</span>(<span class="string">&quot;0x6d5dcddf009824bcd4fcd5afdf4a8713b08bbb6ab6209b2840756cac667bbce6&quot;</span>)                         <span class="comment">//查询交易</span></span><br><span class="line">eth.<span class="built_in">getCode</span>(<span class="string">&quot;&quot;</span>)                                   <span class="comment">//查询合约是否部署成功</span></span><br></pre></td></tr></table></figure>


<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">©2021 ZhouJin, Shandong University, elford233@gmail.com</span><br><span class="line">Last edit time 2021/12/15</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/blog.github.io/2022/03/21/cloud-computing-assignment2/" rel="prev" title="cloud-computing-assignment2">
      <i class="fa fa-chevron-left"></i> cloud-computing-assignment2
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%BC%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">综述</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87-lt"><span class="nav-number">1.1.</span> <span class="nav-text">一、环境准备&lt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E6%90%AD%E5%BB%BA%E7%A7%81%E9%93%BE"><span class="nav-number">1.2.</span> <span class="nav-text">二、搭建私链</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E8%BF%9E%E6%8E%A5%E7%A7%81%E9%93%BE%E4%B8%8EMetaMask"><span class="nav-number">1.3.</span> <span class="nav-text">三、连接私链与MetaMask</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%9B%E3%80%81Remix%E9%83%A8%E7%BD%B2%E5%90%88%E7%BA%A6"><span class="nav-number">1.4.</span> <span class="nav-text">四、Remix部署合约</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E5%87%A0%E4%B8%AA%E9%87%8D%E8%A6%81%E7%9A%84%E5%9C%B0%E5%9D%80"><span class="nav-number">1.5.</span> <span class="nav-text">五、几个重要的地址</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%AD%E3%80%81Golang%E9%83%A8%E7%BD%B2%E5%90%88%E7%BA%A6"><span class="nav-number">1.6.</span> <span class="nav-text">六、Golang部署合约</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E8%B0%83%E7%94%A8%E5%90%88%E7%BA%A6"><span class="nav-number">1.7.</span> <span class="nav-text">七、调用合约</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Zhou Jin</p>
  <div class="site-description" itemprop="description">View my github at @https://github.com/roomdestroyer</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog.github.io/archives/">
        
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhou Jin</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/blog.github.io/lib/anime.min.js"></script>
  <script src="/blog.github.io/lib/velocity/velocity.min.js"></script>
  <script src="/blog.github.io/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog.github.io/js/utils.js"></script>

<script src="/blog.github.io/js/motion.js"></script>


<script src="/blog.github.io/js/schemes/muse.js"></script>


<script src="/blog.github.io/js/next-boot.js"></script>




  















  

  

<script src="/blog.github.io/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/blog.github.io/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body>
</html>
